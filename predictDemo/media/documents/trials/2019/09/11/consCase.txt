$username = "imb_intra"; // Mysql username
$password = "2nf6fwV3UeQ79vej"; // Mysql password


SELECT 
tbl_consultingCase.case_id,
tbl_consultingCase.client_id,
tbl_consultingCase.timestamp,
tbl_consultingCase.last_update,
tbl_consultingCase.case_medicalQuestion,
tbl_consultingCase.case_additionalInformation,
tbl_consultingCase.case_consultingQuestion,
tbl_firstAppointment.appointment_id,
tbl_firstAppointment.appointment_date,
tbl_firstAppointment.appointment_time,
tbl_firstAppointConsultant.user_id,
tbl_users.user_name
FROM `tbl_consultingCase`
LEFT JOIN tbl_firstAppointment ON tbl_firstAppointment.case_id = tbl_consultingCase.case_id LEFT JOIN tbl_firstAppointConsultant ON tbl_firstAppointConsultant.appointment_id = tbl_firstAppointment.appointment_id LEFT JOIN tbl_users on tbl_users.user_id = tbl_firstAppointConsultant.user_id
WHERE tbl_firstAppointment.appointment_date < CURDATE()
AND `case_assignedConsultant_id` IS NULL AND case_closed is null


SELECT *
FROM tbl_firstAppointment
LEFT JOIN tbl_consultingCase ON tbl_consultingCase.case_id = tbl_firstAppointment.case_id
WHERE appointment_date = '2016-10-12'


SELECT tbl_consultingCase.case_id, tbl_client.client_id, tbl_client.client_lastName, tbl_client.client_firstName,
		                tbl_consultingCase.caseType_id, tbl_firstAppointment.appointment_date, tbl_firstAppointment.appointment_time,
		                tbl_consultingCase.case_medicalQuestion, tbl_users.user_name, tbl_consultingCase.caseDetail_id, 
		                tbl_consultingCase.case_closed, 
		                tbl_consultingCase.case_oldData, case_assignedConsultant_id
		                FROM tbl_consultingCase 
		                NATURAL JOIN tbl_client NATURAL JOIN tbl_firstAppointment LEFT OUTER JOIN tbl_users 
		                ON tbl_consultingCase.case_assignedConsultant_id = tbl_users.user_id 
		                WHERE tbl_firstAppointment.appointment_date < DATE_ADD(SYSDATE(), INTERVAL -1 DAY) 
		                ORDER BY tbl_client.client_lastName ASC, tbl_client.client_firstName ASC



<?php
    session_start();
    //if(!isset($_SESSION['uid'])){
        //			echo "Die Session ist abgelaufen.";
      //  header("location:registration.php");
    //} else {
        $tmp = 0;
        $tmp = $_POST['tmpID'];
        $uid = $_SESSION['uid'];
        require_once 'src/subpages.php';
        
        try {
            $db = new dbConn;
            $sql = "SELECT * FROM tbl_firstAppointment WHERE tbl_firstAppointment.appointment_date > SYSDATE() AND tbl_firstAppointment.case_id IS NULL ";
            $stmt = $db->conn->prepare($sql, array(PDO::ATTR_CURSOR => PDO::CURSOR_SCROLL));
            $stmt->execute();
            $rowCnt = $stmt->rowCount();
            echo "Zeilenanzahl: ".$rowCnt;
            if ($rowCnt > 0) {
                // wenn Termine zur Auswahl stehen
                $phpBody .= "<fieldset><legende>Please choose an appointment:</legende>";
                $phpBody .= "<ol>"; $cnt = 1;
                while ($row = $stmt->fetch(PDO::FETCH_NUM, PDO::FETCH_ORI_NEXT)) {
                    $phpBody .= "<li>";
                    if ($cnt == 1) {
                        if($row[4] == 0) {
                            $phpBody .= "<input type='radio' class='radio' name='termin' id='".$row[0]."' value='".$row[0]."' checked>";
                            $phpBody .= "<label for='".$row[0]."'>".$row[1]." ".$row[2]." (ger)</label>";
                        } else {
                            $phpBody .= "<input type='radio' class='radio' name='termin' id='".$row[0]."' value='".$row[0]."' checked>";
                            $phpBody .= "<label for='".$row[0]."'>".$row[1]." ".$row[2]."</label>";
                        }
                    } else {
                        if($row[4] == 0) {
                            $phpBody .= "<input type='radio' class='radio' name='termin' id='".$row[0]."' value='".$row[0]."'>";
                            $phpBody .= "<label for='".$row[0]."'>".$row[1]." ".$row[2]." (ger)</label>";
                        } else {
                            $phpBody .= "<input type='radio' class='radio' name='termin' id='".$row[0]."' value='".$row[0]."'>";
                            $phpBody .= "<label for='".$row[0]."'>".$row[1]." ".$row[2]."</label>";
                        }
                    }
                    $phpBody .= "</li>"; $cnt++;
                }
                $phpBody .= "<li>";
                $phpBody .= "<input type='radio' class='radio' name='termin' id='callBack' value='callBack'>";
                $phpBody .= "<label for='callBack'>Please call back/individual date agreement</label>";
                $phpBody .= "</li><li>";
                $phpBody .= "<input type='radio' class='radio' name='termin' id='dataOnly' value='dataOnly'>";
                $phpBody .= "<label for='dataOnly'>No date agreement/just transfer data</label><br /><br />";
                $phpBody .= "<div class='form-group'><input id='dataOnly_add' name='dataOnly_add' ".
                    "type='text' placeholder='Reason for sending data without an appointment agreement' disabled><br />".
                    "<sub>(eg Appointment already pre-agreed with [name of consultant]/date, time)</sub> ".
                    "</div>"; // (z.B. Termin bereits abgesprochen mit [Name des Mitarbeiters])
                $phpBody .= "</li>";
                $phpBody .= "</ol>";
                $phpBody .= "</fieldset>";
            } else {
                $phpBody .= "<fieldset><legende>We're sorry, there are currently no upcoming time slots available. ".
                    "Please send us your data, we will contact you immediately by phone or e-mail. ".
                    "Thank you so much!</legende></fieldset>";
            } 

       // } else {
            
        //}

        } 			catch (PDOException $e) {
            $err = "Error: " . $e->getMessage();
        }	
        print $phpBody;
    
?>	